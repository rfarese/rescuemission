<h1><%= @question.title %></h1>

<p id="question_description"><%= use_markdown(@question.description) %></p>
<%= link_to 'Edit Question', edit_question_path(@question) %><br>
<%= link_to 'Delete Question', question_path(@question), method: :delete %>

<h2>Answers</h2>

<% if Answer.where(question_id: @question.id, best_answer: true).first %>
  <h3>Best Answer</h3>
  <% best_answer = Answer.where(question_id: @question.id, best_answer: true).first %>
    <p class="best-answer"><%= best_answer.description %></p>
<% end %>

  <table>
    <tr>
      <th>Set New Best Answer</th>
      <th>Answer</th>
    </tr>
    <% @question.answers.each do |answer| %>
      <% unless answer.best_answer == true %>
        <tr id="<%= dom_id(answer) %>">
          <td><%= link_to "Best Answer", "/questions/#{answer.question_id}/answers/#{answer.id}", method: :patch %></td>
          <td><%= use_markdown(answer.description) %></td>
        </tr>
      <% end %>
    <% end %>
  </table>

<h2>Add an Answer:</h2>
<%= form_for([@question, @question.answers.build]) do |f| %>
  <p>
    <%= f.label :description %><br>
    <%= f.text_area :description %>
  </p>
  <p>
    <%= f.submit %>
  </p>
<% end %>

<%= link_to "Back to Questions", questions_path %>
